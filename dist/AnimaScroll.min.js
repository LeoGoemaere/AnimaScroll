"use strict";function _toConsumableArray(n){return _arrayWithoutHoles(n)||_iterableToArray(n)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(n){if(Symbol.iterator in Object(n)||"[object Arguments]"===Object.prototype.toString.call(n))return Array.from(n)}function _arrayWithoutHoles(n){if(Array.isArray(n)){for(var t=0,e=new Array(n.length);t<n.length;t++)e[t]=n[t];return e}}function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function _createClass(n,t,e){return t&&_defineProperties(n.prototype,t),e&&_defineProperties(n,e),n}function delegateTo(n,t){var e,i=n.element,r=n.withSelector,o=!!document.querySelector(r);if(e=!i.matches(r)&&o?null!==i.closest(r):!!o){var a=i.closest(r);t(a)}}var Animation=function(){function n(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.fromValue,r=void 0===i?null:i,o=e.toValue,a=void 0===o?null:o,s=e.duration,u=void 0===s?null:s,l=e.direction,c=void 0===l?"scrollY":l,m=e.timingCurve,h=void 0===m?"linear":m;_classCallCheck(this,n),this.fromValue=r,this.toValue=a,this.duration=u,this.direction=c,this.timingCurve=h,this.animationProgress=0,this.currentAnimationRange=0,this.isAnimationRunning=!1,this.onProgress=null,this.onComplete=null,this.requestAnim=null,window.addEventListener("wheel",function(){return t.stop()})}return _createClass(n,[{key:"animate",value:function(){var n=this;if(!this.isAnimationRunning){var t=null,e=function i(e){n.isAnimationRunning=!0,null===t&&(t=e);var r=e-t;n.currentAnimationRange=n._getAnimationRange(r,n.duration);var o=n.currentAnimationRange>=0&&n.currentAnimationRange<=1;n._processingAnimationProgress(),n._scrolling({delay:n.delay,animationPosition:n.animationProgress}),o?(n.requestAnim=requestAnimationFrame(i),n._runCallbackFunctions(n.onProgress,{parameters:[n.animationProgress,n.currentAnimationRange]})):(n.isAnimationRunning=!1,n.animationProgress=n.toValue,n.currentAnimationRange=1,n._scrolling({animationPosition:n.animationProgress}),n._runCallbackFunctions(n.onProgress,{parameters:[n.animationProgress,n.currentAnimationRange]}),n._runCallbackFunctions(n.onComplete),t=null,n._resetAnimationDatas())};this.requestAnim=requestAnimationFrame(e)}}},{key:"run",value:function(){this.animate()}},{key:"stop",value:function(){this.isAnimationRunning&&(this.isAnimationRunning=!1,this._resetAnimationDatas(),cancelAnimationFrame(this.requestAnim))}},{key:"_processingAnimationProgress",value:function(){this.animationProgress=this._getAnimProgress({timingCurve:n.timingCurves[this.timingCurve],animationRange:this.currentAnimationRange,animDistance:this._getAnimDistance(this.fromValue,this.toValue),currentToValue:this._getCurrentToValue(this.fromValue,this.toValue)}),this.toValue<this.fromValue&&(this.animationProgress-=this.fromValue,this.animationProgress=Math.abs(this.animationProgress-this._getCurrentToValue(this.fromValue,this.toValue)))}},{key:"_scrolling",value:function(t){var e=t.animationPosition;switch(this.direction){case n.directions.scrollY:window.scrollTo(window.scrollX,e);break;case n.directions.scrollX:window.scrollTo(e,window.scrollY);break;default:window.scrollTo(this.from,e)}}},{key:"_getAnimDistance",value:function(n,t){return n<t?t-n:n-t}},{key:"_getAnimProgress",value:function(n){var t=n.timingCurve,e=n.animationRange,i=n.animDistance,r=n.currentToValue;return t(e)*i+r}},{key:"_getCurrentToValue",value:function(n,t){return t>n?n:t}},{key:"_getAnimationRange",value:function(n,t){return n/t}},{key:"_resetAnimationDatas",value:function(){this.animationProgress=0,this.currentAnimationRange=0}},{key:"_runCallbackFunctions",value:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.parameters;null!==n&&("undefined"==typeof e?n():n.apply(void 0,_toConsumableArray(e)))}}],[{key:"directions",get:function(){return{scrollX:"scrollX",scrollY:"scrollY"}}},{key:"timingCurves",get:function(){return{linear:function(n){return n},easeInQuad:function(n){return n*n},easeOutQuad:function(n){return n*(2-n)},easeInOutQuad:function(n){return n<.5?2*n*n:-1+(4-2*n)*n},easeInCubic:function(n){return n*n*n},easeOutCubic:function(n){return--n*n*n+1},easeInOutCubic:function(n){return n<.5?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1},easeInQuart:function(n){return n*n*n*n},easeOutQuart:function(n){return 1- --n*n*n*n},easeInOutQuart:function(n){return n<.5?8*n*n*n*n:1-8*--n*n*n*n},easeInQuint:function(n){return n*n*n*n*n},easeOutQuint:function(n){return 1+--n*n*n*n*n},easeInOutQuint:function(n){return n<.5?16*n*n*n*n*n:1+16*--n*n*n*n*n}}}}]),n}(),AnimaScroll=function(){function n(t){var e=t.link,i=t.duration,r=t.timingCurve,o=t.shiftBy;_classCallCheck(this,n),this.link=e,this.duration=i,this.timingCurve=r,this.shiftBy=o,this.anchor=document.querySelector(this.link.hash),this.onComplete=null,this.onProgress=null}return _createClass(n,[{key:"init",value:function(){var n=this;document.addEventListener("click",function(t){delegateTo({element:t.target,withSelector:'[href="'.concat(n.link.hash,'"]')},function(){t.preventDefault(),n._scrollingTo(n._scrollingDistanceFrom(n.anchor))})})}},{key:"_scrollingDistanceFrom",value:function(n){return n.getBoundingClientRect().top+(window.scrollY||window.pageYOffset)}},{key:"_scrollingDistanceToBeSubstractedFrom",value:function(n){var t=n.split(",");return t.every(function(n){return document.querySelector(n)})?Array.from(t).map(function(n){return document.querySelector(n).offsetHeight}).reduce(function(n,t){return n+t}):console.error("One of your shiftBy selector doesn't exist.")}},{key:"_updateUrl",value:function(n){var t=n.hash;history.pushState?history.pushState(null,null,t):location.hash=t}},{key:"_scrollingTo",value:function(n){this._updateUrl({hash:this.link.hash});var t=new Animation({fromValue:window.scrollY,toValue:this.shiftBy?n-this._scrollingDistanceToBeSubstractedFrom(this.shiftBy):n,duration:this.duration||0,timingCurve:this.timingCurve||"linear"});t.run(),this.onComplete&&"function"==typeof this.onComplete&&(t.onComplete=this.onComplete),this.onProgress&&"function"==typeof this.onProgress&&(t.onProgress=this.onProgress)}}],[{key:"_withDOM",value:function(){var t=document.querySelectorAll("[data-anima-link]");t.forEach(function(t){return new n({link:t,duration:t.getAttribute("data-anima-duration")||null,timingCurve:t.getAttribute("data-anima-timing-curve")||null,shiftBy:t.getAttribute("data-anima-shiftBy")||null}).init()})}},{key:"timingCurves",get:function(){return Animation.timingCurves}}]),n}();document.addEventListener("DOMContentLoaded",AnimaScroll._withDOM);